!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/core"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-draggable-droppable",["exports","rxjs","@angular/core","rxjs/operators"],t):t(e["angular-draggable-droppable"]={},e.rxjs,e.ng.core,e.rxjs.operators)}(this,function(e,i,o,c){"use strict";function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s}var t=function(){this.currentDrag=new i.Subject},n=function(){function e(e,t,n,r){this.element=e,this.renderer=t,this.draggableHelper=n,this.zone=r,this.dragAxis={x:!0,y:!0},this.dragSnapGrid={},this.ghostDragEnabled=!0,this.dragCursor="move",this.dragPointerDown=new o.EventEmitter,this.dragStart=new o.EventEmitter,this.dragging=new o.EventEmitter,this.dragEnd=new o.EventEmitter,this.pointerDown=new i.Subject,this.pointerMove=new i.Subject,this.pointerUp=new i.Subject,this.eventListenerSubscriptions={}}return e.prototype.ngOnInit=function(){var s=this;this.checkEventListeners();var e=this.pointerDown.pipe(c.filter(function(){return s.canDrag()})).pipe(c.mergeMap(function(t){var r=new i.Subject;s.zone.run(function(){s.dragPointerDown.next({x:0,y:0})});var e=s.pointerMove.pipe(c.map(function(e){return e.event.preventDefault(),{currentDrag:r,x:e.clientX-t.clientX,y:e.clientY-t.clientY,clientX:e.clientX,clientY:e.clientY}})).pipe(c.map(function(e){return s.dragSnapGrid.x&&(e.x=Math.floor(e.x/s.dragSnapGrid.x)*s.dragSnapGrid.x),s.dragSnapGrid.y&&(e.y=Math.floor(e.y/s.dragSnapGrid.y)*s.dragSnapGrid.y),e})).pipe(c.map(function(e){return s.dragAxis.x||(e.x=0),s.dragAxis.y||(e.y=0),e})).pipe(c.filter(function(e){var t=e.x,n=e.y;return!s.validateDrag||s.validateDrag({x:t,y:n})})).pipe(c.takeUntil(i.merge(s.pointerUp,s.pointerDown))).pipe(c.share());return e.pipe(c.take(1)).subscribe(function(){t.event.preventDefault(),s.zone.run(function(){s.dragStart.next({x:0,y:0})}),s.setCursor(s.dragCursor),s.draggableHelper.currentDrag.next(r)}),e.pipe(c.takeLast(1)).subscribe(function(e){var t=e.x,n=e.y;s.zone.run(function(){s.dragEnd.next({x:t,y:n})}),r.complete(),s.setCssTransform(""),s.ghostDragEnabled&&s.renderer.setStyle(s.element.nativeElement,"pointerEvents","")}),e})).pipe(c.share());i.merge(e.pipe(c.take(1)).pipe(c.map(function(e){return[,e]})),e.pipe(c.pairwise())).pipe(c.filter(function(e){var t=p(e,2),n=t[0],r=t[1];return!n||(n.x!==r.x||n.y!==r.y)})).pipe(c.map(function(e){var t=p(e,2);t[0];return t[1]})).subscribe(function(e){var t=e.x,n=e.y,r=e.currentDrag,i=e.clientX,o=e.clientY;s.zone.run(function(){s.dragging.next({x:t,y:n})}),s.ghostDragEnabled&&s.renderer.setStyle(s.element.nativeElement,"pointerEvents","none"),s.setCssTransform("translate("+t+"px, "+n+"px)"),r.next({clientX:i,clientY:o,dropData:s.dropData})})},e.prototype.ngOnChanges=function(e){e.dragAxis&&this.checkEventListeners()},e.prototype.ngOnDestroy=function(){this.unsubscribeEventListeners(),this.pointerDown.complete(),this.pointerMove.complete(),this.pointerUp.complete()},e.prototype.checkEventListeners=function(){var t=this,e=this.canDrag(),n=0<Object.keys(this.eventListenerSubscriptions).length;e&&!n?this.zone.runOutsideAngular(function(){t.eventListenerSubscriptions.mousedown=t.renderer.listen(t.element.nativeElement,"mousedown",function(e){t.onMouseDown(e)}),t.eventListenerSubscriptions.mouseup=t.renderer.listen("document","mouseup",function(e){t.onMouseUp(e)}),t.eventListenerSubscriptions.touchstart=t.renderer.listen(t.element.nativeElement,"touchstart",function(e){t.onTouchStart(e)}),t.eventListenerSubscriptions.touchend=t.renderer.listen("document","touchend",function(e){t.onTouchEnd(e)}),t.eventListenerSubscriptions.touchcancel=t.renderer.listen("document","touchcancel",function(e){t.onTouchEnd(e)}),t.eventListenerSubscriptions.mouseenter=t.renderer.listen(t.element.nativeElement,"mouseenter",function(){t.onMouseEnter()}),t.eventListenerSubscriptions.mouseleave=t.renderer.listen(t.element.nativeElement,"mouseleave",function(){t.onMouseLeave()})}):!e&&n&&this.unsubscribeEventListeners()},e.prototype.onMouseDown=function(e){var t=this;this.eventListenerSubscriptions.mousemove||(this.eventListenerSubscriptions.mousemove=this.renderer.listen("document","mousemove",function(e){t.pointerMove.next({event:e,clientX:e.clientX,clientY:e.clientY})})),this.pointerDown.next({event:e,clientX:e.clientX,clientY:e.clientY})},e.prototype.onMouseUp=function(e){this.eventListenerSubscriptions.mousemove&&(this.eventListenerSubscriptions.mousemove(),delete this.eventListenerSubscriptions.mousemove),this.pointerUp.next({event:e,clientX:e.clientX,clientY:e.clientY})},e.prototype.onTouchStart=function(e){var t=this;this.eventListenerSubscriptions.touchmove||(this.eventListenerSubscriptions.touchmove=this.renderer.listen("document","touchmove",function(e){t.pointerMove.next({event:e,clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY})})),this.pointerDown.next({event:e,clientX:e.touches[0].clientX,clientY:e.touches[0].clientY})},e.prototype.onTouchEnd=function(e){this.eventListenerSubscriptions.touchmove&&(this.eventListenerSubscriptions.touchmove(),delete this.eventListenerSubscriptions.touchmove),this.pointerUp.next({event:e,clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY})},e.prototype.onMouseEnter=function(){this.setCursor(this.dragCursor)},e.prototype.onMouseLeave=function(){this.setCursor("")},e.prototype.setCssTransform=function(t){var n=this;if(this.ghostDragEnabled){["transform","-webkit-transform","-ms-transform","-moz-transform","-o-transform"].forEach(function(e){n.renderer.setStyle(n.element.nativeElement,e,t)})}},e.prototype.canDrag=function(){return this.dragAxis.x||this.dragAxis.y},e.prototype.setCursor=function(e){this.renderer.setStyle(this.element.nativeElement,"cursor",e)},e.prototype.unsubscribeEventListeners=function(){var t=this;Object.keys(this.eventListenerSubscriptions).forEach(function(e){t.eventListenerSubscriptions[e](),delete t.eventListenerSubscriptions[e]})},e.decorators=[{type:o.Directive,args:[{selector:"[mwlDraggable]"}]}],e.ctorParameters=function(){return[{type:o.ElementRef},{type:o.Renderer2},{type:t},{type:o.NgZone}]},e.propDecorators={dropData:[{type:o.Input}],dragAxis:[{type:o.Input}],dragSnapGrid:[{type:o.Input}],ghostDragEnabled:[{type:o.Input}],validateDrag:[{type:o.Input}],dragCursor:[{type:o.Input}],dragPointerDown:[{type:o.Output}],dragStart:[{type:o.Output}],dragging:[{type:o.Output}],dragEnd:[{type:o.Output}]},e}();var r=function(){function e(e,t,n){this.element=e,this.draggableHelper=t,this.zone=n,this.dragEnter=new o.EventEmitter,this.dragLeave=new o.EventEmitter,this.dragOver=new o.EventEmitter,this.drop=new o.EventEmitter}return e.prototype.ngOnInit=function(){var i=this;this.currentDragSubscription=this.draggableHelper.currentDrag.subscribe(function(e){var u,t,a=i.element.nativeElement.getBoundingClientRect(),n=e.pipe(c.map(function(e){var t,n,r,i=e.clientX,o=e.clientY,s=e.dropData;return u=s,n=o,(t=i)>=(r=a).left&&t<=r.right&&n>=r.top&&n<=r.bottom})),r=n.pipe(c.distinctUntilChanged());r.pipe(c.filter(function(e){return e})).subscribe(function(){t=!0,i.zone.run(function(){i.dragEnter.next({dropData:u})})}),n.pipe(c.filter(function(e){return e})).subscribe(function(){i.zone.run(function(){i.dragOver.next({dropData:u})})}),r.pipe(c.pairwise()).pipe(c.filter(function(e){var t=p(e,2),n=t[0],r=t[1];return n&&!r})).subscribe(function(){t=!1,i.zone.run(function(){i.dragLeave.next({dropData:u})})}),e.pipe(c.mergeMap(function(){return n})).subscribe({complete:function(){t&&i.zone.run(function(){i.drop.next({dropData:u})})}})})},e.prototype.ngOnDestroy=function(){this.currentDragSubscription.unsubscribe()},e.decorators=[{type:o.Directive,args:[{selector:"[mwlDroppable]"}]}],e.ctorParameters=function(){return[{type:o.ElementRef},{type:t},{type:o.NgZone}]},e.propDecorators={dragEnter:[{type:o.Output}],dragLeave:[{type:o.Output}],dragOver:[{type:o.Output}],drop:[{type:o.Output}]},e}(),s=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[t]}},e.decorators=[{type:o.NgModule,args:[{declarations:[n,r],exports:[n,r]}]}],e}();e.DragAndDropModule=s,e.DraggableHelper=t,e.ɵa=n,e.ɵb=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular-draggable-droppable.umd.min.js.map