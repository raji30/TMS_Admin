(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/common'), require('@angular/forms'), require('rxjs/Observable')) :
	typeof define === 'function' && define.amd ? define(['exports', '@angular/core', '@angular/common', '@angular/forms', 'rxjs/Observable'], factory) :
	(factory((global.ngxBootstrapModal = {}),global.ng.core,global.ng.common,global.ng.forms,global.Rx));
}(this, (function (exports,core,common,forms,Observable) { 'use strict';

var DialogServiceConfig = /** @class */ (function () {
    function DialogServiceConfig() {
        this.container = null;
    }
    return DialogServiceConfig;
}());
var DialogService = /** @class */ (function () {
    /**
     * @param {ComponentFactoryResolver} resolver
     * @param {ApplicationRef} applicationRef
     * @param {Injector} injector
     * @param {DialogServiceConfig} config
     */
    function DialogService(resolver, applicationRef, injector, config) {
        this.resolver = resolver;
        this.applicationRef = applicationRef;
        this.injector = injector;
        this.container = config && config.container;
        this.DEFOPT = config && config.builtInOptions;
    }
    /**
     * Adds dialog
     * @param {Type<DialogComponent<T, T1>>} component
     * @param {T?} data
     * @param {DialogOptions?} options
     * @return {Observable<T1>}
     */
    /**
         * Adds dialog
         * @param {Type<DialogComponent<T, T1>>} component
         * @param {T?} data
         * @param {DialogOptions?} options
         * @return {Observable<T1>}
         */
    DialogService.prototype.addDialog = /**
         * Adds dialog
         * @param {Type<DialogComponent<T, T1>>} component
         * @param {T?} data
         * @param {DialogOptions?} options
         * @return {Observable<T1>}
         */
    function (component, data, options) {
        if (!this.dialogHolderComponent) {
            this.dialogHolderComponent = this.createDialogHolder();
        }
        return this.dialogHolderComponent.addDialog(component, data, options);
    };
    /**
     * Hides and removes dialog from DOM
     * @param {DialogComponent} component
     */
    /**
         * Hides and removes dialog from DOM
         * @param {DialogComponent} component
         */
    DialogService.prototype.removeDialog = /**
         * Hides and removes dialog from DOM
         * @param {DialogComponent} component
         */
    function (component) {
        if (!this.dialogHolderComponent) {
            return;
        }
        this.dialogHolderComponent.removeDialog(component);
    };
    /**
     * Closes all dialogs
     */
    /**
         * Closes all dialogs
         */
    DialogService.prototype.removeAll = /**
         * Closes all dialogs
         */
    function () {
        this.dialogHolderComponent.clear();
    };
    /**
     * Creates and add to DOM dialog holder component
     * @return {DialogHolderComponent}
     */
    /**
         * Creates and add to DOM dialog holder component
         * @return {DialogHolderComponent}
         */
    DialogService.prototype.createDialogHolder = /**
         * Creates and add to DOM dialog holder component
         * @return {DialogHolderComponent}
         */
    function () {
        var _this = this;
        var componentFactory = this.resolver.resolveComponentFactory(DialogHolderComponent);
        var componentRef = componentFactory.create(this.injector);
        var componentRootNode = componentRef.hostView.rootNodes[0];
        if (!this.container)
            this.container = document.body;
        this.applicationRef.attachView(componentRef.hostView);
        componentRef.onDestroy(function () {
            _this.applicationRef.detachView(componentRef.hostView);
        });
        this.container.appendChild(componentRootNode);
        return componentRef.instance;
    };
    /**
     * 构建一个内置模态
     * @param builtInOptions 内置配置参数
     * @param options 模态配置参数
     */
    /**
         * 构建一个内置模态
         * @param builtInOptions 内置配置参数
         * @param options 模态配置参数
         */
    DialogService.prototype.show = /**
         * 构建一个内置模态
         * @param builtInOptions 内置配置参数
         * @param options 模态配置参数
         */
    function (builtInOptions, options) {
        var opt = Object.assign({
            type: 'default',
            size: 'sm',
            input: 'text',
            inputOptions: {},
            inputAttributes: {},
            showCloseButton: true,
            showCancelButton: true,
            cancelButtonText: '取消',
            cancelButtonClass: 'btn-default',
            showConfirmButton: true,
            confirmButtonText: '确认',
            confirmButtonClass: 'btn-primary'
        }, this.DEFOPT, builtInOptions);
        this.addDialog(BuiltInComponent, {
            opt: opt
        }, this.mergerDialog({
            timeout: 0,
            backdrop: true,
            backdropColor: 'rgba(0,0,0,.5)',
            keyboard: true
        }, Object.assign(builtInOptions, options))).subscribe(function (res) {
            if (opt.onHide)
                opt.onHide(res);
        });
        if (opt.onShow)
            opt.onShow();
    };
    DialogService.prototype.mergerDialog = function (options, built) {
        var newOptions = {};
        if (!built)
            return newOptions;
        Object.keys(options).forEach(function (key) {
            if (typeof built[key] !== 'undefined')
                newOptions[key] = built[key];
        });
        return newOptions;
    };
    /**
     * Show Alter
     *
     * @param {string} title
     * @param {string} content
     * @param {BuiltInOptions} 覆盖内置配置参数
     */
    /**
         * Show Alter
         *
         * @param {string} title
         * @param {string} content
         * @param {BuiltInOptions} 覆盖内置配置参数
         */
    DialogService.prototype.alert = /**
         * Show Alter
         *
         * @param {string} title
         * @param {string} content
         * @param {BuiltInOptions} 覆盖内置配置参数
         */
    function (title, content, options) {
        this.show(Object.assign({}, options, {
            type: 'alert',
            title: title,
            content: content,
            showCancelButton: false
        }), this.mergerDialog({
            timeout: 0,
            backdrop: true,
            backdropColor: 'rgba(0,0,0,.5)',
            keyboard: true
        }, options));
    };
    /**
     * Show confirm
     *
     * @param {string} title
     * @param {string} content
     * @param {BuiltInOptions} 覆盖内置配置参数
     * @returns {Promise<boolean>} 返回一个Promise布尔类型
     */
    /**
         * Show confirm
         *
         * @param {string} title
         * @param {string} content
         * @param {BuiltInOptions} 覆盖内置配置参数
         * @returns {Promise<boolean>} 返回一个Promise布尔类型
         */
    DialogService.prototype.confirm = /**
         * Show confirm
         *
         * @param {string} title
         * @param {string} content
         * @param {BuiltInOptions} 覆盖内置配置参数
         * @returns {Promise<boolean>} 返回一个Promise布尔类型
         */
    function (title, content, options) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.show(Object.assign({}, options, {
                type: 'confirm',
                title: title,
                content: content,
                onHide: function (res) {
                    resolve(res === undefined ? false : res);
                }
            }), _this.mergerDialog({
                timeout: 0,
                backdrop: 'static',
                backdropColor: 'rgba(0,0,0,.5)',
                keyboard: false
            }, options));
        });
    };
    /**
     * Show prompt
     *
     * @param {string} title
     * @param {BuiltInOptions} 覆盖内置配置参数
     * @returns {Promise<any>} 返回一个Promise任意类型
     */
    /**
         * Show prompt
         *
         * @param {string} title
         * @param {BuiltInOptions} 覆盖内置配置参数
         * @returns {Promise<any>} 返回一个Promise任意类型
         */
    DialogService.prototype.prompt = /**
         * Show prompt
         *
         * @param {string} title
         * @param {BuiltInOptions} 覆盖内置配置参数
         * @returns {Promise<any>} 返回一个Promise任意类型
         */
    function (title, options) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.show(Object.assign({
                input: 'text',
                inputRequired: true,
                inputError: '不可为空'
            }, options, {
                type: 'prompt',
                title: title,
                onHide: function (res) {
                    resolve(res);
                }
            }), _this.mergerDialog({
                timeout: 0,
                backdrop: 'static',
                backdropColor: 'rgba(0,0,0,.5)',
                keyboard: false
            }, options));
        });
    };
    DialogService.decorators = [
        { type: core.Injectable },
    ];
    /** @nocollapse */
    DialogService.ctorParameters = function () { return [
        { type: core.ComponentFactoryResolver, },
        { type: core.ApplicationRef, },
        { type: core.Injector, },
        { type: DialogServiceConfig, decorators: [{ type: core.Optional },] },
    ]; };
    return DialogService;
}());

/**
 * Abstract dialog
 * @template T - dialog data;
 * @template T1 - dialog result
 */
var DialogComponent = /** @class */ (function () {
    /**
     * Constructor
     * @param {DialogService} dialogService - instance of DialogService
     */
    function DialogComponent(dialogService) {
        this.dialogService = dialogService;
    }
    /**
     *
     * @param {T} data
     * @return {Observable<T1>}
     */
    /**
         *
         * @param {T} data
         * @return {Observable<T1>}
         */
    DialogComponent.prototype.fillData = /**
         *
         * @param {T} data
         * @return {Observable<T1>}
         */
    function (data) {
        var _this = this;
        data = data || {};
        var keys = Object.keys(data);
        for (var i = 0, length_1 = keys.length; i < length_1; i++) {
            var key = keys[i];
            this[key] = data[key];
        }
        return Observable.Observable.create(function (observer) {
            _this.observer = observer;
            return function () { return _this.close(); };
        });
    };
    /**
     * Closes dialog
     */
    /**
         * Closes dialog
         */
    DialogComponent.prototype.close = /**
         * Closes dialog
         */
    function (result) {
        if (typeof result !== 'undefined')
            this.result = result;
        this.dialogService.removeDialog(this);
        if (this.observer) {
            this.observer.next(this.result);
            this.observer.complete();
        }
    };
    /** @nocollapse */
    DialogComponent.ctorParameters = function () { return [
        { type: DialogService, decorators: [{ type: core.Inject, args: [DialogService,] },] },
    ]; };
    return DialogComponent;
}());

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var BuiltInComponent = /** @class */ (function (_super) {
    __extends(BuiltInComponent, _super);
    function BuiltInComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.checkboxMap = {};
        _this.classs = {};
        _this.prompError = false;
        return _this;
    }
    BuiltInComponent.prototype.ngOnInit = function () {
        var _this = this;
        var options = this.opt;
        if (options.className)
            this.classs[options.className] = true;
        if (options.icon)
            this.classs['has-icon'] = true;
        if (options.type === 'prompt') {
            if (!options.inputRegex) {
                switch (options.input) {
                    case 'email':
                        options.inputRegex = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                        if (!options.inputError)
                            options.inputError = '邮箱格式不正确';
                        break;
                    case 'url':
                        options.inputRegex = /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/;
                        if (!options.inputError)
                            options.inputError = '网址格式不正确';
                        break;
                }
            }
            if (options.inputOptions && !Array.isArray(options.inputOptions)) {
                var keys = [];
                // tslint:disable-next-line:forin
                for (var key in options.inputOptions) {
                    keys.push({ key: key, text: options.inputOptions[key] });
                }
                options.inputOptions = keys;
            }
            options.inputOptions = Object.assign([], options.inputOptions);
            options.inputAttributes = Object.assign({
                maxlength: null,
                min: 0,
                max: 100,
                step: 1
            }, options.inputAttributes);
        }
        // 默认值
        var defaultValue = options.inputValue;
        if (options.input === 'checkbox' && !Array.isArray(options.inputValue)) {
            defaultValue = typeof defaultValue !== 'undefined' ? [defaultValue] : [];
        }
        options.inputValue = defaultValue || '';
        console.log(options);
        this.promptData = options.inputValue;
        if (this.promptData) {
            this.promptCheck();
        }
        setTimeout(function () {
            _this.setFocus();
        }, 100);
    };
    BuiltInComponent.prototype.promptCheck = function () {
        if (this.opt.inputRequired === true) {
            if (this.opt.input === 'checkbox' && this.promptData.length === 0) {
                this.prompError = true;
                return false;
            }
            if (!this.promptData) {
                this.prompError = true;
                return false;
            }
        }
        if (this.opt.inputRegex && !this.opt.inputRegex.test(this.promptData.toString())) {
            this.prompError = true;
            return false;
        }
        this.prompError = false;
        return true;
    };
    BuiltInComponent.prototype.setFocus = function () {
        var containerEl = this.container.nativeElement;
        var firstFormEl = null;
        if (this.opt.type === 'prompt') {
            firstFormEl = containerEl.querySelector('input, textarea, select');
        }
        else {
            firstFormEl = containerEl.querySelector('button.confirm');
        }
        if (firstFormEl)
            firstFormEl.focus();
    };
    BuiltInComponent.prototype.onChanage = function () {
        this.promptCheck();
    };
    BuiltInComponent.prototype.onKeyup = function (event) {
        if (event.keyCode === 13) {
            this.ok();
        }
    };
    BuiltInComponent.prototype.ok = function () {
        switch (this.opt.type) {
            case 'confirm':
                this.result = true;
                break;
            case 'prompt':
                if (!this.promptCheck())
                    return;
                var ret = this.promptData;
                if (this.opt.input === 'checkbox') {
                    ret = this.opt.inputOptions
                        .filter(function (item) { return item._checked; })
                        .map(function (item) {
                        delete item._checked;
                        return item;
                    });
                }
                this.result = ret;
                break;
        }
        this.close();
    };
    BuiltInComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'dialog-built-in',
                    template: "<div class=\"modal-dialog modal-{{opt.size}}\" [ngClass]=\"classs\" #container>\n                <div class=\"modal-content\" [ngClass]=\"{'text-center':opt.icon}\">\n                   <div class=\"modal-header\" *ngIf=\"opt.title\" [hidden]=\"opt.icon\">\n                     <h5 class=\"modal-title\">{{opt.title}}</h5>\n                    <button *ngIf=\"opt.showCloseButton\" type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" (click)=\"close()\">\n                        <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                   </div>\n                   <div class=\"modal-body\">\n                    <div *ngIf=\"opt.icon\" [ngSwitch]=\"opt.icon\">\n                        <div class=\"modal-icon modal-error animate-error-icon\" *ngSwitchCase=\"'error'\">\n                            <span class=\"x-mark animate-x-mark\"><span class=\"x-mark-line-left\"></span><span class=\"x-mark-line-right\"></span></span>\n                        </div>\n                        <div class=\"modal-icon modal-question\" *ngSwitchCase=\"'question'\">?</div>\n                        <div class=\"modal-icon modal-warning\" *ngSwitchCase=\"'warning'\">!</div>\n                        <div class=\"modal-icon modal-info\" *ngSwitchCase=\"'info'\">i</div>\n                        <div class=\"modal-icon modal-success animate-success-icon\" *ngSwitchCase=\"'success'\">\n                            <div class=\"success-circular-line-left\" style=\"background: rgb(255, 255, 255);\"></div>\n                            <span class=\"success-line-tip animate-success-line-tip\"></span>\n                            <span class=\"success-line-long animate-success-line-long\"></span>\n                            <div class=\"success-ring\"></div>\n                            <div class=\"success-fix\" style=\"background: rgb(255, 255, 255);\"></div>\n                            <div class=\"success-circular-line-right\" style=\"background: rgb(255, 255, 255);\"></div>\n                        </div>\n                    </div>\n                     <div *ngIf=\"opt.content\" [innerHTML]=\"opt.content\"></div>\n                     <div [ngSwitch]=\"opt.input\" *ngIf=\"opt.type === 'prompt'\" class=\"modal-{{opt.type}}\" [ngClass]=\"{'has-danger has-error': prompError}\">\n                        <textarea *ngSwitchCase=\"'textarea'\" placeholder=\"{{opt.inputPlaceholder}}\" [(ngModel)]=\"promptData\"\n                            class=\"form-control\" [ngClass]=\"{'form-control-danger': prompError}\"></textarea>\n                        <select *ngSwitchCase=\"'select'\" [(ngModel)]=\"promptData\" name=\"promptData\"\n                            (ngModelChange)=\"onChanage()\"\n                            class=\"form-control\" [ngClass]=\"{'form-control-danger': prompError}\">\n                            <option *ngFor=\"let i of opt.inputOptions\" [ngValue]=\"i\">{{i.text}}</option>\n                        </select>\n                        <div *ngSwitchCase=\"'range'\" class=\"row modal-range\">\n                            <div class=\"col-{{opt.size}}-9\">\n                                <input type=\"range\" [min]=\"opt.inputAttributes.min\" [max]=\"opt.inputAttributes.max\" [(ngModel)]=\"promptData\" name=\"promptData\"\n                                    (ngModelChange)=\"onChanage()\" class=\"form-control\">\n                            </div>\n                            <div class=\"col-{{opt.size}}-3\"><p class=\"form-control-static\">{{promptData}}</p></div>\n                        </div>\n                        <div *ngSwitchCase=\"'checkbox'\">\n                            <label *ngFor=\"let i of opt.inputOptions\" class=\"checkbox-inline custom-control custom-checkbox\">\n                                <input type=\"checkbox\" [(ngModel)]=\"i._checked\" [value]=\"i\" name=\"checkbox1\"\n                                    class=\"custom-control-input\">\n                                <span class=\"custom-control-indicator\"></span>\n                                <span class=\"custom-control-description\"> {{i.text}}</span>\n                            </label>\n                        </div>\n                        <div *ngSwitchCase=\"'radio'\">\n                            <label *ngFor=\"let i of opt.inputOptions\" class=\"radio-inline custom-control custom-radio\">\n                                <input type=\"radio\" (click)=\"promptData=i\" [checked]=\"i===promptData\" class=\"custom-control-input\">\n                                <span class=\"custom-control-indicator\"></span>\n                                <span class=\"custom-control-description\"> {{i.text}}</span>\n                            </label>\n                        </div>\n                        <input *ngSwitchDefault type=\"{{opt.input}}\"\n                            placeholder=\"{{opt.inputPlaceholder}}\" [(ngModel)]=\"promptData\" name=\"promptData\"\n                            (ngModelChange)=\"onChanage()\" (keyup)=\"onKeyup($event)\" [maxlength]=\"opt.inputAttributes.maxlength\"\n                            class=\"form-control\" [ngClass]=\"{'form-control-danger': prompError}\">\n                        <div class=\"form-control-feedback\" *ngIf=\"prompError\">{{opt.inputError}}</div>\n                    </div>\n                   </div>\n                   <div class=\"modal-footer\" *ngIf=\"opt.showConfirmButton || opt.showCancelButton\">\n                     <button type=\"button\" class=\"cancel btn\" tabIndex=\"2\" (click)=\"close()\" [ngClass]=\"opt.cancelButtonClass\" [hidden]=\"!opt.showCancelButton\">{{opt.cancelButtonText}}</button>\n                     <button type=\"button\" class=\"confirm btn\" tabIndex=\"1\" (click)=\"ok()\" [disabled]=\"prompError\" [ngClass]=\"opt.confirmButtonClass\" [hidden]=\"!opt.showConfirmButton\">{{opt.confirmButtonText}}</button>\n                   </div>\n                </div>\n             </div>",
                    styles: [".modal-dialog .modal-title { display: inline-block; } .modal-range [type=\"range\"] { box-shadow: none; } .modal-prompt textarea { height: 108px; padding: 12px; } .modal-prompt .form-control-feedback { font-size: 12px; position: inherit; width: inherit; text-align: left; } .modal-icon { width: 80px; height: 80px; border: 4px solid transparent; border-radius: 50%; margin: 20px auto 30px; padding: 0; position: relative; box-sizing: content-box; cursor: default; user-select: none; -webkit-tap-highlight-color: transparent; } .modal-icon.modal-error { border-color: #f27474; } .modal-icon.modal-error .x-mark { position: relative; display: block; } .modal-icon.modal-error [class^='x-mark-line'] { position: absolute; height: 5px; width: 47px; background-color: #f27474; display: block; top: 37px; border-radius: 2px; } .modal-icon.modal-error [class^='x-mark-line'][class$='left'] { transform: rotate(45deg); left: 17px; } .modal-icon.modal-error [class^='x-mark-line'][class$='right'] { transform: rotate(-45deg); right: 16px; } .modal-icon.modal-warning { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #f8bb86; border-color: #facea8; font-size: 60px; line-height: 80px; text-align: center; } .modal-icon.modal-info { font-family: 'Open Sans', sans-serif; color: #3fc3ee; border-color: #9de0f6; font-size: 60px; line-height: 80px; text-align: center; } .modal-icon.modal-question { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #87adbd; border-color: #c9dae1; font-size: 60px; line-height: 80px; text-align: center; } .modal-icon.modal-success { border-color: #a5dc86; } .modal-icon.modal-success [class^='success-circular-line'] { border-radius: 50%; position: absolute; width: 60px; height: 120px; transform: rotate(45deg); } .modal-icon.modal-success [class^='success-circular-line'][class$='left'] { border-radius: 120px 0 0 120px; top: -7px; left: -33px; transform: rotate(-45deg); transform-origin: 60px 60px; } .modal-icon.modal-success [class^='success-circular-line'][class$='right'] { border-radius: 0 120px 120px 0; top: -11px; left: 30px; transform: rotate(-45deg); transform-origin: 0 60px; } .modal-icon.modal-success .success-ring { width: 80px; height: 80px; border: 4px solid rgba(165, 220, 134, 0.2); border-radius: 50%; box-sizing: content-box; position: absolute; left: -4px; top: -4px; z-index: 2; } .modal-icon.modal-success .success-fix { width: 7px; height: 90px; position: absolute; left: 28px; top: 8px; z-index: 1; transform: rotate(-45deg); } .modal-icon.modal-success [class^='success-line'] { height: 5px; background-color: #a5dc86; display: block; border-radius: 2px; position: absolute; z-index: 2; } .modal-icon.modal-success [class^='success-line'][class$='tip'] { width: 25px; left: 14px; top: 46px; transform: rotate(45deg); } .modal-icon.modal-success [class^='success-line'][class$='long'] { width: 47px; right: 8px; top: 38px; transform: rotate(-45deg); } @keyframes animate-success-tip { 0% { width: 0; left: 1px; top: 19px; } 54% { width: 0; left: 1px; top: 19px; } 70% { width: 50px; left: -8px; top: 37px; } 84% { width: 17px; left: 21px; top: 48px; } 100% { width: 25px; left: 14px; top: 45px; } } @keyframes animate-success-long { 0% { width: 0; right: 46px; top: 54px; } 65% { width: 0; right: 46px; top: 54px; } 84% { width: 55px; right: 0; top: 35px; } 100% { width: 47px; right: 8px; top: 38px; } } @keyframes rotatePlaceholder { 0% { transform: rotate(-45deg); } 5% { transform: rotate(-45deg); } 12% { transform: rotate(-405deg); } 100% { transform: rotate(-405deg); } } .animate-success-line-tip { animation: animate-success-tip 0.75s; } .animate-success-line-long { animation: animate-success-long 0.75s; } .modal-success.animate-success-icon .success-circular-line-right { animation: rotatePlaceholder 4.25s ease-in; } @keyframes animate-error-icon { 0% { transform: rotateX(100deg); opacity: 0; } 100% { transform: rotateX(0deg); opacity: 1; } } .animate-error-icon { animation: animate-error-icon 0.5s; } @keyframes animate-x-mark { 0% { transform: scale(0.4); margin-top: 26px; opacity: 0; } 50% { transform: scale(0.4); margin-top: 26px; opacity: 0; } 80% { transform: scale(1.15); margin-top: -6px; } 100% { transform: scale(1); margin-top: 0; opacity: 1; } } .animate-x-mark { animation: animate-x-mark 0.5s; } @keyframes rotate-loading { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } "],
                    encapsulation: core.ViewEncapsulation.None,
                    preserveWhitespaces: false
                },] },
    ];
    /** @nocollapse */
    BuiltInComponent.ctorParameters = function () { return []; };
    BuiltInComponent.propDecorators = {
        "container": [{ type: core.ViewChild, args: ['container',] },],
    };
    return BuiltInComponent;
}(DialogComponent));

var DialogWrapperComponent = /** @class */ (function () {
    /**
     * Constructor
     * @param {ComponentFactoryResolver} resolver
     * @param {DialogService} dialogService
     */
    function DialogWrapperComponent(resolver, dialogService) {
        this.resolver = resolver;
        this.dialogService = dialogService;
    }
    /**
     * Adds content dialog component to wrapper
     * @param {Type<DialogComponent>} component
     * @return {DialogComponent}
     */
    /**
       * Adds content dialog component to wrapper
       * @param {Type<DialogComponent>} component
       * @return {DialogComponent}
       */
    DialogWrapperComponent.prototype.addComponent = /**
       * Adds content dialog component to wrapper
       * @param {Type<DialogComponent>} component
       * @return {DialogComponent}
       */
    function (component) {
        var _this = this;
        var factory = this.resolver.resolveComponentFactory(component);
        var injector = core.ReflectiveInjector.fromResolvedProviders([], this.element.injector);
        var componentRef = factory.create(injector);
        this.element.insert(componentRef.hostView);
        this.content = componentRef.instance;
        this.content.wrapper = this;
        if (component !== BuiltInComponent) {
            setTimeout(function () {
                _this.setFocus();
            }, 100);
        }
        return this.content;
    };
    /**
     * Registers event handler to close dialog by click on backdrop
     */
    /**
       * Registers event handler to close dialog by click on backdrop
       */
    DialogWrapperComponent.prototype.closeByClickOutside = /**
       * Registers event handler to close dialog by click on backdrop
       */
    function () {
        var _this = this;
        var containerEl = this.container.nativeElement;
        containerEl.querySelector('.modal-content').addEventListener('click', function (event) {
            event.stopPropagation();
        });
        containerEl.addEventListener('click', function () {
            _this.dialogService.removeDialog(_this.content);
        }, false);
    };
    DialogWrapperComponent.prototype.setFocus = function () {
        var containerEl = this.container.nativeElement;
        var autoFocusEl = containerEl.querySelector('[autofocus]');
        if (autoFocusEl)
            autoFocusEl.focus();
    };
    DialogWrapperComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'dialog-wrapper',
                    template: "\n    <div #container class=\"modal fade\" style=\"display:block !important;\" role=\"dialog\">\n        <ng-template #element></ng-template>\n    </div>\n    ",
                    preserveWhitespaces: false
                },] },
    ];
    /** @nocollapse */
    DialogWrapperComponent.ctorParameters = function () { return [
        { type: core.ComponentFactoryResolver, },
        { type: DialogService, },
    ]; };
    DialogWrapperComponent.propDecorators = {
        "element": [{ type: core.ViewChild, args: ['element', { read: core.ViewContainerRef },] },],
        "container": [{ type: core.ViewChild, args: ['container',] },],
    };
    return DialogWrapperComponent;
}());

var DialogHolderComponent = /** @class */ (function () {
    /**
     * Constructor
     * @param {ComponentFactoryResolver} resolver
     */
    function DialogHolderComponent(resolver) {
        this.resolver = resolver;
        /**
             * Array of dialogs
             * @type {Array<DialogComponent> }
             */
        this.dialogs = [];
    }
    /**
     * Adds dialog
     * @param {Type<DialogComponent>} component
     * @param {object?} data
     * @param {DialogOptions?} options
     * @return {Observable<*>}
     */
    /**
         * Adds dialog
         * @param {Type<DialogComponent>} component
         * @param {object?} data
         * @param {DialogOptions?} options
         * @return {Observable<*>}
         */
    DialogHolderComponent.prototype.addDialog = /**
         * Adds dialog
         * @param {Type<DialogComponent>} component
         * @param {object?} data
         * @param {DialogOptions?} options
         * @return {Observable<*>}
         */
    function (component, data, options) {
        var _this = this;
        options = Object.assign({
            backdrop: true,
            backdropColor: 'rgba(0,0,0,.5)',
            keyboard: true
        }, options);
        if (options.backdrop === false)
            options.backdropColor = '';
        // add body class if this is the only dialog in the stack
        if (!document.body.classList.contains('modal-open')) {
            document.body.classList.add('modal-open');
        }
        var factory = this.resolver.resolveComponentFactory(DialogWrapperComponent);
        var componentRef = this.element.createComponent(factory, options.index);
        var dialogWrapper = componentRef.instance;
        var _component = dialogWrapper.addComponent(component);
        _component.options = options;
        if (typeof (options.index) !== 'undefined') {
            this.dialogs.splice(options.index, 0, _component);
        }
        else {
            this.dialogs.push(_component);
        }
        setTimeout(function () {
            dialogWrapper.container.nativeElement.classList.add('show');
            dialogWrapper.container.nativeElement.classList.add('in');
        });
        if (options.timeout && options.timeout > 0) {
            setTimeout(function () {
                _this.removeDialog(_component);
            }, options.timeout);
        }
        if (options.backdrop === true) {
            dialogWrapper.closeByClickOutside();
        }
        if (options.backdropColor) {
            dialogWrapper.container.nativeElement.style.backgroundColor = options.backdropColor;
        }
        return _component.fillData(data);
    };
    /**
     * Removes dialog
     * @param {DialogComponent} component
     */
    /**
         * Removes dialog
         * @param {DialogComponent} component
         */
    DialogHolderComponent.prototype.removeDialog = /**
         * Removes dialog
         * @param {DialogComponent} component
         */
    function (component) {
        var _this = this;
        var element = component.wrapper.container.nativeElement;
        element.classList.remove('show');
        element.classList.remove('in');
        setTimeout(function () {
            _this._removeElement(component);
            _this.dialogs.length === 0 && document.body.classList.remove('modal-open');
        }, 300);
    };
    DialogHolderComponent.prototype._removeElement = function (component) {
        var index = this.dialogs.indexOf(component);
        if (index > -1) {
            this.element.remove(index);
            this.dialogs.splice(index, 1);
        }
    };
    DialogHolderComponent.prototype.clear = function () {
        this.element.clear();
        this.dialogs = [];
    };
    DialogHolderComponent.prototype.documentKeypress = function (event) {
        // 检查是否最后一个
        if (this.dialogs.length <= 0)
            return;
        // 移除最新一个组件
        var component = this.dialogs[this.dialogs.length - 1];
        if (component.options.keyboard === true && event.keyCode === 27)
            this.removeDialog(component);
    };
    DialogHolderComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'dialog-holder',
                    template: '<ng-template #element></ng-template>'
                },] },
    ];
    /** @nocollapse */
    DialogHolderComponent.ctorParameters = function () { return [
        { type: core.ComponentFactoryResolver, },
    ]; };
    DialogHolderComponent.propDecorators = {
        "element": [{ type: core.ViewChild, args: ['element', { read: core.ViewContainerRef },] },],
        "documentKeypress": [{ type: core.HostListener, args: ['window:keydown', ['$event'],] },],
    };
    return DialogHolderComponent;
}());

/**
 * Dialog service factory. Creates dialog service with options
 * @param { ComponentFactoryResolver } resolver
 * @param { ApplicationRef } applicationRef
 * @param { Injector } injector
 * @param { DialogServiceConfig } options
 * @return { DialogService }
 */
function dialogServiceFactory(resolver, applicationRef, injector, options) {
    return new DialogService(resolver, applicationRef, injector, options);
}
var BootstrapModalModule = /** @class */ (function () {
    function BootstrapModalModule() {
    }
    BootstrapModalModule.forRoot = function (config) {
        return {
            ngModule: BootstrapModalModule,
            providers: [
                { provide: DialogServiceConfig, useValue: config },
                {
                    provide: DialogService,
                    useFactory: dialogServiceFactory,
                    deps: [core.ComponentFactoryResolver, core.ApplicationRef, core.Injector, DialogServiceConfig]
                }
            ]
        };
    };
    BootstrapModalModule.forChild = function () {
        return {
            ngModule: BootstrapModalModule,
            providers: [
                {
                    provide: DialogService,
                    useFactory: dialogServiceFactory,
                    deps: [core.ComponentFactoryResolver, core.ApplicationRef, core.Injector, DialogServiceConfig]
                }
            ]
        };
    };
    BootstrapModalModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        forms.FormsModule
                    ],
                    declarations: [
                        DialogHolderComponent,
                        DialogWrapperComponent,
                        BuiltInComponent
                    ],
                    providers: [
                        DialogService
                    ],
                    entryComponents: [
                        DialogHolderComponent,
                        DialogWrapperComponent,
                        BuiltInComponent
                    ]
                },] },
    ];
    /** @nocollapse */
    BootstrapModalModule.ctorParameters = function () { return []; };
    return BootstrapModalModule;
}());

exports.dialogServiceFactory = dialogServiceFactory;
exports.BootstrapModalModule = BootstrapModalModule;
exports.DialogComponent = DialogComponent;
exports.DialogService = DialogService;
exports.DialogServiceConfig = DialogServiceConfig;
exports.BuiltInComponent = BuiltInComponent;

Object.defineProperty(exports, '__esModule', { value: true });

})));
