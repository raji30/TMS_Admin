{
  "version": 3,
  "file": "ngx-document-view.js",
  "sources": [
    "ng://ngx-document-view/src/app/document-view/document-view.module.ts",
    "ng://ngx-document-view/src/app/document-view/document-view.directive.ts",
    "ng://ngx-document-view/src/app/document-view/models/ViewProviders.ts"
  ],
  "sourcesContent": [
    "import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { DocumentViewDirective } from './document-view.directive';\r\nimport { SafePipeModule } from 'safe-pipe';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, SafePipeModule],\r\n  declarations: [DocumentViewDirective],\r\n  exports: [DocumentViewDirective]\r\n})\r\nexport class DocumentViewModule {}\r\n",
    "import { element } from 'protractor';\r\nimport {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  ElementRef,\r\n  ViewChild,\r\n  Output\r\n} from '@angular/core';\r\nimport { ViewProviders } from './models/ViewProviders';\r\nimport { UriBuilder } from 'uribuilder';\r\nimport { cleanPath } from 'cleanpath';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { TimerObservable } from 'rxjs/observable/TimerObservable';\r\nimport 'rxjs/operator/toPromise';\r\nimport 'rxjs/operator/takeUntil';\r\nimport { Directive } from '@angular/core';\r\nimport { EventEmitter } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: 'iframe[ngx-document]'\r\n})\r\nexport class DocumentViewDirective implements OnInit {\r\n  private _provider: ViewProviders = ViewProviders.google;\r\n  private _originSrc: string;\r\n  /**\r\n   * 檢視器提供者\r\n   */\r\n  @Input()\r\n  public set provider(value: ViewProviders) {\r\n    this._provider = value;\r\n    this.ngOnInit();\r\n  }\r\n\r\n  public get provider(): ViewProviders {\r\n    return this._provider;\r\n  }\r\n\r\n  @Output() public providerChange = new EventEmitter<ViewProviders>();\r\n\r\n  /**\r\n   * 原始文件連結\r\n   */\r\n  public get originSrc(): string {\r\n    return this._originSrc;\r\n  }\r\n\r\n  constructor(private iframe: ElementRef) {\r\n    this._originSrc = (this.iframe.nativeElement as HTMLIFrameElement).src;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    (this.iframe\r\n      .nativeElement as HTMLIFrameElement).src = this.getDocumentUrl();\r\n  }\r\n\r\n  /**\r\n   * 根據對應的檢視器提供者產生文件網址\r\n   */\r\n  public getDocumentUrl(): string {\r\n    if (this.provider === ViewProviders.google) {\r\n      return (\r\n        'http://docs.google.com/gview?url=' +\r\n        encodeURI(this._originSrc) +\r\n        '&embedded=true'\r\n      );\r\n    } else if (this.provider === ViewProviders.microsoft) {\r\n      return (\r\n        'https://view.officeapps.live.com/op/embed.aspx?src=' +\r\n        encodeURI(this._originSrc)\r\n      );\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 轉換連結與編碼\r\n   * @param url 連結\r\n   */\r\n  encodeURI(url: string): string {\r\n    if (UriBuilder.parse(url).isRelative()) {\r\n      url = cleanPath(document.baseURI + '/' + url);\r\n    }\r\n    return encodeURIComponent(url);\r\n  }\r\n}\r\n",
    "/**\r\n * 檢視器服務提供者\r\n */\r\nexport enum ViewProviders {\r\n  /**\r\n   * Google\r\n   */\r\n  google = 'google',\r\n  /**\r\n   * Microsoft\r\n   */\r\n  microsoft = 'microsoft'\r\n}\r\n"
  ],
  "names": [],
  "mappings": ";;;;;;;;;;;;;;;;;IEOA,MAAA,EAAW,QAAQ;;;;IAInB,SAAA,EAAc,WAAW;;;;;;;ADVzB,AAqBA,MAAA,qBAAA,CAAA;;;;IAyBE,WAAF,CAAsB,MAAkB,EAAxC;QAAsB,IAAtB,CAAA,MAA4B,GAAN,MAAM,CAAY;QAxBxC,IAAA,CAAA,SAAA,GAAqC,aAAa,CAAC,MAAM,CAAzD;QAeA,IAAA,CAAA,cAAA,GAAoC,IAAI,YAAY,EAAiB,CAArE;QAUI,IAAI,CAAC,UAAU,GAAG,mBAAC,IAAI,CAAC,MAAM,CAAC,aAAkC,GAAE,GAAG,CAAC;KACxE;;;;;;IApBH,IAAa,QAAQ,CAAC,KAAoB,EAA1C;QACI,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,QAAQ,EAAE,CAAC;;;;;IAGpB,IAAa,QAAQ,GAArB;QACI,OAAO,IAAI,CAAC,SAAS,CAAC;;;;;;IAQ1B,IAAa,SAAS,GAAtB;QACI,OAAO,IAAI,CAAC,UAAU,CAAC;;;;;IAOzB,QAAQ,GAAV;QACI,mBAAC,IAAI,CAAC,MAAM;aACT,aAAkC,GAAE,GAAG,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;KACpE;;;;;IAKM,cAAc,GAAvB;QACI,IAAI,IAAI,CAAC,QAAQ,KAAK,aAAa,CAAC,MAAM,EAAE;YAC1C,QACE,mCAAmC;gBACnC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC;gBAC1B,gBAAgB,EAChB;SACH;aAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,aAAa,CAAC,SAAS,EAAE;YACpD,QACE,qDAAqD;gBACrD,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,EAC1B;SACH;QAED,OAAO,IAAI,CAAC;;;;;;;IAOd,SAAS,CAAC,GAAW,EAAvB;QACI,IAAI,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,EAAE;YACtC,GAAG,GAAG,SAAS,CAAC,QAAQ,CAAC,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;SAC/C;QACD,OAAO,kBAAkB,CAAC,GAAG,CAAC,CAAC;KAChC;;;IAlEH,EAAA,IAAA,EAAC,SAAS,EAAV,IAAA,EAAA,CAAW;gBACT,QAAQ,EAAE,sBAAsB;aACjC,EAAD,EAAA;;;;IAhBA,EAAA,IAAA,EAAE,UAAU,GAAZ;;;IAuBA,UAAA,EAAA,CAAA,EAAA,IAAA,EAAG,KAAK,EAAR,EAAA;IAUA,gBAAA,EAAA,CAAA,EAAA,IAAA,EAAG,MAAM,EAAT,EAAA;;;;;;;ADtCA,AAUA,MAAA,kBAAA,CAAA;;;IALA,EAAA,IAAA,EAAC,QAAQ,EAAT,IAAA,EAAA,CAAU;gBACR,OAAO,EAAE,CAAC,YAAY,EAAE,cAAc,CAAC;gBACvC,YAAY,EAAE,CAAC,qBAAqB,CAAC;gBACrC,OAAO,EAAE,CAAC,qBAAqB,CAAC;aACjC,EAAD,EAAA;;;;;;;;;;;;;;;;;;;;"
}
